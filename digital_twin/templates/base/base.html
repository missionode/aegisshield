<!DOCTYPE html>
<html class="dark" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>{% block title %}Plant Doctor - Save Your Plants with AI{% endblock %}</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=Epilogue:wght@400;500;700;900&amp;display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
    <style type="text/tailwindcss">
        @theme {
            --color-primary: #3a6960;
            --color-deep-moss: #3a6960;
            --color-snow-blossom: #fdfcfc;
            --color-soil-grey: #64748b;
            --color-sunlight-glow: #F59E0B;
            --color-accent-pink: #D7A3A6;
            --color-bark-brown: #433422;
            --color-background-light: #fdfcfc;
            --color-background-dark: #18302d;
            --color-surface-dark: #2B443F;

            --font-display: "Epilogue", sans-serif;

            --radius-DEFAULT: 0.5rem;
            --radius-lg: 1rem;
            --radius-xl: 1.5rem;
            --radius-full: 9999px;
        }
        @custom-variant dark (&:where(.dark, .dark *));
    </style>
    <style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
        body {
            font-family: 'Epilogue', sans-serif;
        }
        body {
            min-height: max(884px, 100dvh);
        }
    </style>
    {% block extra_head %}{% endblock %}
</head>
<body class="bg-snow-blossom dark:bg-background-dark text-slate-900 dark:text-white transition-colors duration-300">
    <div class="relative flex min-h-screen w-full flex-col overflow-x-hidden">
        <!-- TopAppBar -->
        <nav class="sticky top-0 z-50 flex items-center bg-snow-blossom/90 dark:bg-background-dark/90 backdrop-blur-md p-4 justify-between border-b border-slate-200 dark:border-primary/20">
            <a href="{% url 'core:index' %}" class="flex items-center relative z-50">
                <div class="text-deep-moss flex size-10 shrink-0 items-center justify-center rounded-lg bg-deep-moss/10">
                    <span class="material-symbols-outlined text-2xl">potted_plant</span>
                </div>
                <h2 class="text-deep-moss dark:text-white text-lg font-bold leading-tight tracking-[-0.015em] flex-1 ml-3 font-display">Plant Doctor</h2>
            </a>
            
            <!-- Desktop Menu -->
            <div class="hidden md:flex items-center gap-6 mr-6">
                <a href="{% url 'core:index' %}" class="text-slate-500 font-medium hover:text-primary transition-colors">Home</a>
                {% if user.is_authenticated %}
                    <a href="{% url 'diagnose:dashboard' %}" class="text-slate-500 font-medium hover:text-primary transition-colors">Dashboard</a>
                {% endif %}
                <a href="{% url 'core:features' %}" class="text-slate-500 font-medium hover:text-primary transition-colors">Features</a>
                <a href="{% url 'core:blog' %}" class="text-slate-500 font-medium hover:text-primary transition-colors">Blog</a>
                
                {% if user.is_authenticated %}
                    <a href="{% url 'users:profile' %}" class="ml-2 w-10 h-10 rounded-full bg-deep-moss/10 flex items-center justify-center overflow-hidden border border-deep-moss/20 hover:border-deep-moss hover:shadow-md transition-all" title="My Profile">
                        {% if user.avatar %}
                            <img src="{{ user.avatar.url }}" alt="{{ user.username }}" class="w-full h-full object-cover">
                        {% else %}
                            <span class="material-symbols-outlined text-deep-moss text-xl">person</span>
                        {% endif %}
                    </a>
                {% else %}
                    <a href="{% url 'users:login' %}" class="text-slate-500 font-medium hover:text-primary transition-colors">Login</a>
                {% endif %}
            </div>

            <!-- Mobile Menu Button -->
            <div class="flex w-10 items-center justify-end md:hidden relative z-50">
                <button id="mobile-menu-btn" class="flex cursor-pointer items-center justify-center rounded-xl h-10 w-10 hover:bg-slate-100 dark:hover:bg-surface-dark transition-colors">
                    <span class="material-symbols-outlined" id="menu-icon">menu</span>
                </button>
            </div>
        </nav>

        <!-- Mobile Menu Overlay -->
        <div id="mobile-menu" class="fixed inset-0 z-40 bg-white/95 dark:bg-background-dark/95 backdrop-blur-xl pt-28 px-8 flex flex-col gap-8 transition-all duration-300 translate-x-full md:hidden">
            <a href="{% url 'core:index' %}" class="text-2xl font-bold text-deep-moss dark:text-white hover:text-primary">Home</a>
            {% if user.is_authenticated %}
                <a href="{% url 'diagnose:dashboard' %}" class="text-2xl font-bold text-deep-moss dark:text-white hover:text-primary">Dashboard</a>
            {% endif %}
            <a href="{% url 'core:features' %}" class="text-2xl font-bold text-deep-moss dark:text-white hover:text-primary">Features</a>
            <a href="{% url 'core:blog' %}" class="text-2xl font-bold text-deep-moss dark:text-white hover:text-primary">Blog</a>
            
            <div class="h-px bg-slate-200 dark:bg-primary/20 w-full my-2"></div>

            {% if user.is_authenticated %}
                <a href="{% url 'users:profile' %}" class="flex items-center gap-4 text-2xl font-bold text-deep-moss dark:text-white hover:text-primary">
                    <div class="w-10 h-10 rounded-full bg-deep-moss/10 flex items-center justify-center overflow-hidden border border-deep-moss/20">
                         {% if user.avatar %}
                            <img src="{{ user.avatar.url }}" alt="{{ user.username }}" class="w-full h-full object-cover">
                        {% else %}
                            <span class="material-symbols-outlined text-deep-moss text-xl">person</span>
                        {% endif %}
                    </div>
                    My Profile
                </a>
            {% else %}
                <a href="{% url 'users:login' %}" class="text-2xl font-bold text-deep-moss dark:text-white hover:text-primary">Login</a>
                <a href="{% url 'users:signup' %}" class="w-full py-4 rounded-xl bg-sunlight-glow text-deep-moss font-bold text-xl text-center shadow-lg">Get Started</a>
            {% endif %}
        </div>

        <script>
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            const menuIcon = document.getElementById('menu-icon');
            let isMenuOpen = false;

            mobileMenuBtn.addEventListener('click', () => {
                isMenuOpen = !isMenuOpen;
                if (isMenuOpen) {
                    mobileMenu.classList.remove('translate-x-full');
                    menuIcon.innerText = 'close';
                    document.body.style.overflow = 'hidden'; // Prevent scrolling
                } else {
                    mobileMenu.classList.add('translate-x-full');
                    menuIcon.innerText = 'menu';
                    document.body.style.overflow = '';
                }
            });
            
            // Close menu when clicking a link
            mobileMenu.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', () => {
                    isMenuOpen = false;
                    mobileMenu.classList.add('translate-x-full');
                    menuIcon.innerText = 'menu';
                    document.body.style.overflow = '';
                });
            });
        </script>

        {% block content %}{% endblock %}

        <!-- Footer -->
        <footer class="bg-slate-100 dark:bg-background-dark/50 border-t border-slate-200 dark:border-primary/10 px-6 py-12">
            <div class="flex flex-col items-center gap-8">
                <div class="flex items-center gap-2 text-primary">
                    <span class="material-symbols-outlined text-2xl">potted_plant</span>
                    <span class="font-display font-bold text-xl tracking-tight text-slate-900 dark:text-white">Plant Doctor</span>
                </div>
                <div class="flex gap-6">
                    <button id="footer-share-btn" class="size-10 flex items-center justify-center rounded-full bg-slate-200 dark:bg-surface-dark text-slate-600 dark:text-white hover:bg-primary hover:text-white transition-all" title="Share Plant Doctor">
                        <span class="material-symbols-outlined">share</span>
                    </button>
                    <a class="size-10 flex items-center justify-center rounded-full bg-slate-200 dark:bg-surface-dark text-slate-600 dark:text-white hover:bg-primary hover:text-white transition-all" href="mailto:contact@plantdoctor.com" title="Contact Us">
                        <span class="material-symbols-outlined">mail</span>
                    </a>
                    <a class="size-10 flex items-center justify-center rounded-full bg-slate-200 dark:bg-surface-dark text-slate-600 dark:text-white hover:bg-primary hover:text-white transition-all" href="https://www.plantdoctor.com" target="_blank" rel="noopener noreferrer" title="Visit Website">
                        <span class="material-symbols-outlined">language</span>
                    </a>
                </div>
                <div class="flex flex-wrap justify-center gap-x-8 gap-y-2 text-sm text-slate-500 dark:text-[#a4b7b4] font-medium">
                    <a href="{% url 'core:privacy_policy' %}" class="hover:text-deep-moss transition-colors">Privacy Policy</a>
                    <a href="{% url 'core:terms_of_service' %}" class="hover:text-deep-moss transition-colors">Terms of Service</a>
                    <a href="{% url 'core:contact_us' %}" class="hover:text-deep-moss transition-colors">Contact Us</a>
                </div>
                <p class="text-xs text-slate-400 dark:text-[#a4b7b4]/50">
                    Â© 2024 Plant Doctor Inc. All rights reserved.
                </p>
            </div>
        </footer>
    </div>
    
    <script>
        document.getElementById('footer-share-btn').addEventListener('click', async () => {
            if (navigator.share) {
                try {
                    await navigator.share({
                        title: 'Plant Doctor',
                        text: 'Check out Plant Doctor - Save Your Plants with AI!',
                        url: window.location.origin
                    });
                } catch (err) {
                    console.log('Error sharing:', err);
                }
            } else {
                // Fallback: Copy to clipboard
                navigator.clipboard.writeText(window.location.origin);
                alert('Link copied to clipboard!');
            }
        });
    </script>
    {% block extra_scripts %}{% endblock %}
</body>
</html>
